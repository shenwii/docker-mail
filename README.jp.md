# **Postfix & Dovecot メールサーバー (Dockerコンテナ版)**

本プロジェクトは、Postfix (MTA) と Dovecot (IMAP/POP3) を使用した、堅牢でコンテナ化された完全なメールシステムソリューションを提供します。システムはモジュール性とセキュリティを向上させるために2つの独立したDockerコンテナで動作し、マッピングされたUnixソケットファイルを介して通信します。

## **特徴**

* **MTA (メール転送エージェント):** Postfix によるメールの送受信。  
* **MDA (メール配送エージェント)/配信:** Dovecot による IMAP/POP3 アクセス。  
* **コンテナ間通信:** マッピングされたUnixソケットを使用して、PostfixとDovecot間で安全かつ効率的に通信します。  
* **仮想ユーザー/ドメイン管理:** **現在、バックエンドのデータストレージとしてMySQLのみをサポートしています。**

## **事前準備**

コンテナを起動する前に、MySQLデータベースが準備され、初期化されていることを確認する必要があります。

1. **SQL初期化:** ユーザー、ドメイン、エイリアス管理に必要なテーブルとビューの定義は、sql フォルダ内のSQLファイルに含まれています。これらのスクリプトをMySQLデータベースインスタンスに適用してください。

## **クイックスタート**

プロジェクトには、すぐに起動するための設定サンプルファイルが含まれています。

1. **環境設定:** サンプル環境ファイルの名前を変更し、値を変更します。  
   cp sample.app.env app.env  
   \# app.env を編集し、特定の設定を行います

2. **Docker Compose 設定:** Docker Compose 設定ファイルの名前を変更します。  
   cp sample.docker-compose.yml docker-compose.yml

3. **システムの起動:** デタッチモードでコンテナを起動します。  
   docker compose up \-d

## **設定説明 (app.env)**

app.env ファイルには、コンテナがデータベースに接続し、TLS設定を処理するために必要な重要な環境変数が含まれています。

| 変数名 | 説明 | サンプル値 |
| :---- | :---- | :---- |
| TLS\_CERY\_FILE | コンテナ内のTLS証明書ファイルへの絶対パス（Postfix/Dovecot用）。 | /ssl/sample.cer |
| TLS\_KEY\_FILE | コンテナ内のTLS秘密鍵ファイルへの絶対パス。 | /ssl/sample.key |
| MAIL\_DOMAIN | メールサーバー用に設定するプライマリメールのドメイン。 | sample.com |
| DB\_USER | メールデータベースへの接続に使用するMySQLユーザー名。 | mysql |
| DB\_PASSWORD | MySQLユーザーのパスワード。 | mysql |
| DB\_PORT | MySQLサーバーのポート番号。 | 3306 |
| DB\_HOST | MySQLサーバーのホスト名またはIPアドレス。 | mysql |
| DB\_DBNAME | ユーザーとドメインのデータを含むメールデータベース名。 | mail |

